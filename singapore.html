<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Report: A Deep Dive into Singapore</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals with Professional Blue Accent -->
    <!-- Application Structure Plan: A thematic dashboard approach is used to transform the linear report into an explorable SPA. The structure includes six key sections: 'At a Glance' (home), 'The People', 'The Economy', 'The City', 'Living Here', and 'The Future'. This design choice breaks down the dense information into logical, digestible narratives, allowing users to navigate based on interest rather than report order. The user flow starts with a high-level summary and enables non-linear exploration via a persistent navigation bar, promoting user engagement and understanding. -->
    <!-- Visualization & Content Choices: Data from the report is visualized to meet specific goals. Demographics (Ethnic/Religion) use interactive Donut charts (Chart.js) for comparing proportions. Economic data (Trade/Sectors) use Bar and Pie charts (Chart.js) for clear comparison. Cost of Living is shown with interactive Bar charts updated via JS based on user selection (lifestyle buttons), personalizing the information. Complex topics like Smart Nation initiatives are organized into clickable icon grids (HTML/CSS/JS) for clarity. New LLM features provide deeper insights: Cultural Insight Generator (People), Economic Trend Explainer (Economy), Smart City Idea Generator (City), and Relocation Advice (Living Here). This selection prioritizes interaction and comprehension, strictly avoiding SVG and Mermaid JS. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body { font-family: 'Inter', sans-serif; }
        .chart-container { position: relative; width: 100%; margin-left: auto; margin-right: auto; }
        .nav-link { transition: all 0.3s ease; }
        .nav-link.active { color: #ffffff; background-color: #2563eb; }
        .nav-link:not(.active):hover { background-color: #f1f5f9; }
        .content-section { display: none; }
        .content-section.active { display: block; }
        .stat-card { transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; }
        .stat-card:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .interactive-btn { transition: background-color 0.2s ease, color 0.2s ease; }
        .interactive-btn.active { background-color: #1d4ed8; color: white; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div class="min-h-screen">
        <header class="bg-white shadow-sm sticky top-0 z-50">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-16">
                    <div class="flex-shrink-0">
                        <h1 class="text-xl font-bold text-slate-900">Singapore: The Interactive Report</h1>
                    </div>
                    <nav class="hidden md:block">
                        <div id="nav-menu" class="flex items-baseline space-x-1">
                            <a href="#glance" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700">At a Glance</a>
                            <a href="#people" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700">The People</a>
                            <a href="#economy" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700">The Economy</a>
                            <a href="#city" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700">The City</a>
                            <a href="#living" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700">Living Here</a>
                            <a href="#future" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700">The Future</a>
                        </div>
                    </nav>
                </div>
            </div>
        </header>

        <main class="py-10">
            <div class="max-w-7xl mx-auto sm:px-6 lg:px-8">
                
                <section id="glance" class="content-section p-4">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl font-extrabold text-slate-900 sm:text-4xl">Singapore at a Glance</h2>
                        <p class="mt-4 text-lg text-slate-600">A high-level overview of the vibrant city-state's key characteristics and achievements.</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                        <div class="stat-card bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-lg font-semibold text-slate-700">Population</h3>
                            <p class="text-4xl font-bold text-blue-600 mt-2">5.92 M</p>
                            <p class="text-sm text-slate-500 mt-1">As of 2025</p>
                        </div>
                        <div class="stat-card bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-lg font-semibold text-slate-700">GDP (Nominal)</h3>
                            <p class="text-4xl font-bold text-blue-600 mt-2">$501 B</p>
                             <p class="text-sm text-slate-500 mt-1">Highly developed economy</p>
                        </div>
                        <div class="stat-card bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-lg font-semibold text-slate-700">Total Area</h3>
                            <p class="text-4xl font-bold text-blue-600 mt-2">719 kmÂ²</p>
                            <p class="text-sm text-slate-500 mt-1">3rd most densely populated</p>
                        </div>
                        <div class="stat-card bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-lg font-semibold text-slate-700">Governance</h3>
                            <p class="text-4xl font-bold text-blue-600 mt-2">Top Tier</p>
                            <p class="text-sm text-slate-500 mt-1">Low corruption, high stability</p>
                        </div>
                    </div>
                     <div class="mt-16 bg-white p-8 rounded-lg shadow">
                        <h3 class="text-2xl font-bold text-slate-900 mb-4">A Nation Forged by Strategy</h3>
                        <p class="text-slate-600 leading-relaxed">
                            Singapore's story is one of remarkable transformation. From a resource-scarce island, it has risen to become a global leader in finance, trade, and innovation. This interactive report explores the core pillars of its success: its diverse and highly skilled population, a dynamic and resilient economy, pioneering urban design, and a clear vision for a sustainable future. Navigate through the sections to uncover the data and strategies that define this unique city-state.
                        </p>
                    </div>
                </section>
                
                <section id="people" class="content-section p-4">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl font-extrabold text-slate-900 sm:text-4xl">The People: A Multicultural Fabric</h2>
                        <p class="mt-4 text-lg text-slate-600">Explore the diverse demographics, cultures, and world-class education system that form the human capital of Singapore.</p>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                        <div class="bg-white p-6 rounded-lg shadow">
                            <h3 class="text-xl font-bold text-center mb-4">Ethnic Composition</h3>
                            <p class="text-center text-slate-600 mb-4">Singapore's society is a vibrant melting pot. Hover over the chart to see the makeup of its major communities.</p>
                            <div class="chart-container h-80">
                                <canvas id="ethnicChart"></canvas>
                            </div>
                        </div>

                        <div class="bg-white p-6 rounded-lg shadow">
                            <h3 class="text-xl font-bold text-center mb-4">Religious Diversity</h3>
                            <p class="text-center text-slate-600 mb-4">A wide array of faiths are practiced freely, reflecting the nation's commitment to harmony.</p>
                            <div class="chart-container h-80">
                                <canvas id="religionChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-12 bg-white p-8 rounded-lg shadow">
                        <h3 class="text-2xl font-bold text-slate-900 mb-4">Festivals & Traditions</h3>
                         <p class="text-slate-600 mb-6">Singapore's calendar is full of vibrant celebrations from its diverse cultures. Click on a festival to learn more about its significance.</p>
                        <div id="festivals-grid" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        </div>
                        <div id="festival-details" class="mt-6 p-4 bg-slate-100 rounded-md" style="display: none;"></div>
                        <div class="mt-8 text-center">
                            <button id="cultural-insight-btn" class="interactive-btn bg-blue-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-600">
                                âœ¨ Get Cultural Insight âœ¨
                            </button>
                            <div id="cultural-insight-output" class="mt-4 p-4 bg-yellow-50 text-yellow-800 rounded-lg hidden"></div>
                        </div>
                    </div>
                </section>

                <section id="economy" class="content-section p-4">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl font-extrabold text-slate-900 sm:text-4xl">The Economy: A Global Powerhouse</h2>
                        <p class="mt-4 text-lg text-slate-600">Discover the twin pillars of manufacturing and services that drive Singapore's high-value, trade-reliant economy.</p>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                        <div class="bg-white p-6 rounded-lg shadow">
                             <h3 class="text-xl font-bold text-center mb-4">GDP Contribution by Sector</h3>
                             <p class="text-center text-slate-600 mb-4">The services sector forms the backbone of the economy, complemented by a strong industrial base.</p>
                            <div class="chart-container h-80">
                                <canvas id="sectorChart"></canvas>
                            </div>
                        </div>

                        <div class="bg-white p-6 rounded-lg shadow">
                             <h3 class="text-xl font-bold text-center mb-4">Top Trading Partners (2021)</h3>
                             <p class="text-center text-slate-600 mb-4">Singapore's prosperity is deeply linked to global trade. Use the buttons to switch between exports and imports.</p>
                            <div class="flex justify-center my-4">
                                <div id="trade-buttons" class="flex space-x-2 bg-slate-200 p-1 rounded-lg">
                                    <button class="trade-btn interactive-btn px-4 py-2 text-sm font-semibold rounded-md" data-type="exports">Exports</button>
                                    <button class="trade-btn interactive-btn px-4 py-2 text-sm font-semibold rounded-md" data-type="imports">Imports</button>
                                </div>
                            </div>
                            <div class="chart-container h-80">
                                <canvas id="tradeChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-12 bg-white p-8 rounded-lg shadow">
                        <h3 class="text-2xl font-bold text-slate-900 mb-4">Key Economic Drivers</h3>
                        <p class="text-slate-600 leading-relaxed">
                            Singapore's economy thrives on a "value-add" philosophy, transforming imported goods and providing high-skill services. This strategy is essential due to its lack of natural resources. Key industries include electronics, financial services, petroleum refining, and biomedical products. The government fosters this environment through pro-business policies, extensive Free Trade Agreements, and strategic investments via Government-Linked Corporations, making it a globally competitive hub for finance and trade.
                        </p>
                        <div class="mt-8 text-center">
                            <button id="economic-explainer-btn" class="interactive-btn bg-blue-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-600">
                                âœ¨ Explain Economic Trends âœ¨
                            </button>
                            <div id="economic-explainer-output" class="mt-4 p-4 bg-yellow-50 text-yellow-800 rounded-lg hidden"></div>
                        </div>
                    </div>
                </section>

                <section id="city" class="content-section p-4">
                     <div class="text-center mb-12">
                        <h2 class="text-3xl font-extrabold text-slate-900 sm:text-4xl">The City: A Smart Nation Blueprint</h2>
                        <p class="mt-4 text-lg text-slate-600">From integrated urban planning to cutting-edge digital services, explore how Singapore builds a liveable and efficient city.</p>
                    </div>
                    
                    <div class="bg-white p-8 rounded-lg shadow">
                        <h3 class="text-2xl font-bold text-slate-900 mb-2">Pioneering Smart Initiatives</h3>
                        <p class="text-slate-600 mb-8 text-center">Singapore leverages technology to enhance urban living, improve mobility, and provide accessible healthcare. Click on an icon to explore a key initiative.</p>
                        <div id="smart-initiatives-grid" class="grid grid-cols-2 md:grid-cols-4 gap-6 text-center">
                        </div>
                        <div id="initiative-details" class="mt-8 p-6 bg-slate-100 rounded-lg" style="display: none;"></div>
                        <div class="mt-8">
                            <h3 class="text-xl font-bold text-slate-900 mb-4">Suggest New Smart City Ideas âœ¨</h3>
                            <input type="text" id="smart-city-prompt-input" class="w-full p-3 border border-slate-300 rounded-lg mb-4" placeholder="e.g., Ideas for sustainable transport or elderly care...">
                            <button id="smart-city-suggest-btn" class="interactive-btn bg-blue-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-600">
                                Generate Ideas
                            </button>
                            <div id="smart-city-ideas-output" class="mt-4 p-4 bg-yellow-50 text-yellow-800 rounded-lg hidden"></div>
                        </div>
                    </div>

                    <div class="mt-12 bg-white p-8 rounded-lg shadow">
                        <h3 class="text-2xl font-bold text-slate-900 mb-4">Integrated Urban Planning for Well-being</h3>
                        <p class="text-slate-600 leading-relaxed mb-4">
                            Singapore's urban development is a masterclass in long-term, integrated planning. The "City in Nature" vision weaves parks and waterways throughout the urban landscape, promoting health and biodiversity. Self-sufficient towns with accessible amenities, a world-class public transport system, and policies that encourage active commuting all contribute to a high quality of life. This holistic approach, where health, environment, and infrastructure are planned in synergy, serves as a global model for sustainable urban living.
                        </p>
                    </div>
                </section>
                
                <section id="living" class="content-section p-4">
                     <div class="text-center mb-12">
                        <h2 class="text-3xl font-extrabold text-slate-900 sm:text-4xl">Living in Singapore: Costs & Comparisons</h2>
                        <p class="mt-4 text-lg text-slate-600">An interactive look at the cost of living in one of the world's most dynamic cities.</p>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                        <div class="bg-white p-6 rounded-lg shadow">
                            <h3 class="text-xl font-bold text-center mb-4">Average Monthly Expenses</h3>
                            <p class="text-center text-slate-600 mb-4">Costs vary significantly by lifestyle. Select a profile below to see an estimated monthly budget.</p>
                            <div class="flex justify-center my-4">
                                <div id="lifestyle-buttons" class="flex flex-wrap justify-center gap-2 bg-slate-200 p-1 rounded-lg">
                                    <button class="lifestyle-btn interactive-btn px-4 py-2 text-sm font-semibold rounded-md" data-lifestyle="student">Student</button>
                                    <button class="lifestyle-btn interactive-btn px-4 py-2 text-sm font-semibold rounded-md" data-lifestyle="professional">Professional</button>
                                    <button class="lifestyle-btn interactive-btn px-4 py-2 text-sm font-semibold rounded-md" data-lifestyle="family">Family</button>
                                </div>
                            </div>
                            <div class="chart-container h-96">
                                <canvas id="costLivingChart"></canvas>
                            </div>
                            <div class="mt-8 text-center">
                                <button id="relocation-advice-btn" class="interactive-btn bg-blue-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-600">
                                    âœ¨ Get Relocation Advice âœ¨
                                </button>
                                <div id="relocation-advice-output" class="mt-4 p-4 bg-yellow-50 text-yellow-800 rounded-lg hidden"></div>
                            </div>
                        </div>

                         <div class="bg-white p-6 rounded-lg shadow">
                            <h3 class="text-xl font-bold text-center mb-4">Cost vs. Other Major Asian Cities</h3>
                            <p class="text-center text-slate-600 mb-4">Singapore is consistently ranked as one of Asia's most expensive cities, alongside hubs like Hong Kong and Dubai.</p>
                             <div class="chart-container h-96">
                                <canvas id="cityComparisonChart"></canvas>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="future" class="content-section p-4">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl font-extrabold text-slate-900 sm:text-4xl">The Future: Sustainable & Resilient</h2>
                        <p class="mt-4 text-lg text-slate-600">Learn about Singapore's forward-looking strategies to tackle climate change and ensure long-term prosperity.</p>
                    </div>
                    
                    <div class="bg-white p-8 rounded-lg shadow">
                        <h3 class="text-2xl font-bold text-slate-900 mb-4">The Singapore Green Plan 2030</h3>
                        <p class="text-slate-600 leading-relaxed mb-6">
                            This whole-of-nation movement charts an ambitious course for sustainable development, with a goal of achieving net zero emissions by 2050. It's a strategic response to the existential threat of climate change for a low-lying island. The plan is built on five key pillars.
                        </p>
                        <div id="green-plan-pillars-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 text-center">
                            <!-- Pillars will be injected by JS -->
                        </div>
                    </div>

                    <div class="mt-12 bg-white p-8 rounded-lg shadow">
                        <h3 class="text-2xl font-bold text-slate-900 mb-4">Strategic Vision & Challenges Ahead</h3>
                        <p class="text-slate-600 leading-relaxed">
                            Singapore's vision is to remain a hub of innovation, sustainability, and high liveability. By continuously investing in its people, technology, and green infrastructure, it aims to turn its inherent vulnerabilitiesâ€”like resource scarcityâ€”into strategic advantages. However, challenges persist. Managing the high cost of living, ensuring food and water security, and navigating a complex global landscape require constant adaptation and proactive governance. Singapore's future success will depend on its ability to balance economic growth with social equity and environmental resilience.
                        </p>
                    </div>
                </section>

            </div>
        </main>
    </div>

<script>
document.addEventListener('DOMContentLoaded', function() {

    const data = {
        people: {
            ethnic: {
                labels: ['Chinese', 'Malay', 'Indian', 'Others'],
                data: [74.3, 13.5, 9.0, 3.2], 
            },
            religion: {
                labels: ['Buddhist', 'Christian', 'No Religion', 'Muslim', 'Taoist', 'Hindu', 'Others'],
                data: [33.9, 18.1, 16.4, 14.3, 11.3, 5.2, 0.8],
            },
            festivals: [
                { name: 'Chinese New Year', details: 'Marked by family reunions, spring cleaning, and exchanging red packets for good fortune. Chinatown is the festive heart.' },
                { name: 'Hari Raya Aidilfitri', details: 'A joyous celebration concluding Ramadan, the month of fasting. It\'s a time for forgiveness and fellowship.' },
                { name: 'Deepavali', details: 'The "Festival of Lights" celebrating the triumph of good over evil. Little India is brightly illuminated.' },
                { name: 'Vesak Day', details: 'Commemorates the birth, enlightenment, and death of Buddha. Devotees make offerings at temples across the island.' },
                { name: 'Christmas', details: 'The birth of Jesus Christ is celebrated with hymns, masses, and festive light-ups, especially along Orchard Road.' },
            ]
        },
        economy: {
            sectors: {
                labels: ['Services', 'Industry', 'Agriculture'],
                data: [75.2, 24.8, 0.5],
            },
            trade: {
                exports: {
                    labels: ['USA', 'China', 'Japan', 'Hong Kong', 'Australia'],
                    data: [12.52, 12.08, 10.34, 4.56, 8.73],
                },
                imports: {
                    labels: ['USA', 'China', 'Japan', 'Hong Kong', 'UK'],
                    data: [22.43, 10.65, 4.71, 4.53, 3.59],
                }
            }
        },
        city: {
            initiatives: [
                { name: 'Smart Traffic', icon: 'ðŸš—', details: 'The Electronic Road Pricing (ERP) system dynamically manages traffic congestion by tolling, while sensor networks optimize traffic flow in real-time.' },
                { name: 'Digital Govt.', icon: 'ðŸ“±', details: 'Through platforms like SingPass and MyInfo, 99% of government services are digitally accessible, streamlining transactions for citizens and businesses.' },
                { name: 'Telemedicine', icon: 'âš•ï¸', details: 'Virtual consultations and remote patient monitoring are used to provide accessible and sustainable healthcare, especially for an aging population.' },
                { name: 'Autonomous Vehicles', icon: 'ðŸ¤–', details: 'Singapore is a global testbed for autonomous vehicles, aiming to revolutionize mobility and improve accessibility for the elderly and disabled.' }
            ]
        },
        living: {
            costs: {
                student: { labels: ['Rent (Shared)', 'Food', 'Transport', 'Utilities', 'Personal'], data: [800, 500, 128, 100, 472] },
                professional: { labels: ['Rent (Condo)', 'Food', 'Transport', 'Utilities', 'Entertainment'], data: [3000, 800, 128, 200, 872] },
                family: { labels: ['Rent (3-Bed)', 'Groceries', 'Transport', 'Education', 'Utilities'], data: [4000, 800, 200, 2000, 300] }
            },
            comparison: {
                labels: ['Kuala Lumpur', 'Seoul', 'Tokyo', 'Singapore', 'Dubai', 'Hong Kong'],
                data: [2250, 3650, 3900, 4750, 5750, 5750], 
            }
        },
        future: {
            pillars: [
                 { name: 'City in Nature', icon: 'ðŸŒ³' },
                 { name: 'Sustainable Living', icon: 'â™»ï¸' },
                 { name: 'Energy Reset', icon: 'â˜€ï¸' },
                 { name: 'Green Economy', icon: 'ðŸ’¼' },
                 { name: 'Resilient Future', icon: 'ðŸ›¡ï¸' }
            ]
        }
    };
    
    const chartColors = ['#2563eb', '#3b82f6', '#60a5fa', '#93c5fd', '#bfdbfe', '#dbeafe', '#eff6ff'];

    let ethnicChart, religionChart, sectorChart, tradeChart, costLivingChart, cityComparisonChart;

    function createDonutChart(ctx, labels, data, title) {
        return new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: labels,
                datasets: [{
                    label: title,
                    data: data,
                    backgroundColor: chartColors,
                    borderColor: '#ffffff',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'bottom', labels: { font: { size: 12 } } },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `${context.label}: ${context.raw}%`;
                            }
                        }
                    }
                }
            }
        });
    }

    function createBarChart(ctx, labels, data, title, isHorizontal = false) {
        return new Chart(ctx, {
            type: isHorizontal ? 'bar' : 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: title,
                    data: data,
                    backgroundColor: chartColors[0],
                    borderColor: chartColors[0],
                    borderWidth: 1
                }]
            },
            options: {
                indexAxis: isHorizontal ? 'y' : 'x',
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    x: { beginAtZero: true, grid: { display: false } },
                    y: { grid: { display: false } }
                }
            }
        });
    }

    function createGroupedBarChart(ctx, initialData) {
        return new Chart(ctx, {
            type: 'bar',
            data: {
                labels: initialData.labels,
                datasets: [{
                    label: 'Trade Value (%)',
                    data: initialData.data,
                    backgroundColor: chartColors[0]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                 scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'Percentage of Total Trade' }
                    }
                }
            }
        });
    }
    
    function createPieChart(ctx, labels, data, title) {
        return new Chart(ctx, {
            type: 'pie',
            data: {
                labels: labels,
                datasets: [{
                    data: data,
                    backgroundColor: chartColors,
                    borderColor: '#ffffff',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'bottom' },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `${context.label}: ${context.raw}%`;
                            }
                        }
                    }
                }
            }
        });
    }
    
    const navLinks = document.querySelectorAll('.nav-link');
    const sections = document.querySelectorAll('.content-section');

    function updateActiveSection(hash) {
        let activeSection = document.querySelector(hash);
        if (!activeSection) {
            hash = '#glance';
            activeSection = document.querySelector(hash);
        }

        navLinks.forEach(link => {
            link.classList.toggle('active', link.hash === hash);
        });
        sections.forEach(section => {
            section.classList.toggle('active', section.id === activeSection.id);
        });
        
        loadChartsForSection(activeSection.id);
    }
    
    function loadChartsForSection(sectionId) {
        switch(sectionId) {
            case 'people':
                if (!ethnicChart) {
                    ethnicChart = createDonutChart(document.getElementById('ethnicChart').getContext('2d'), data.people.ethnic.labels, data.people.ethnic.data, 'Ethnic Composition');
                }
                if (!religionChart) {
                    religionChart = createDonutChart(document.getElementById('religionChart').getContext('2d'), data.people.religion.labels, data.people.religion.data, 'Religious Diversity');
                }
                break;
            case 'economy':
                 if (!sectorChart) {
                    sectorChart = createPieChart(document.getElementById('sectorChart').getContext('2d'), data.economy.sectors.labels, data.economy.sectors.data, 'GDP by Sector');
                }
                if (!tradeChart) {
                    tradeChart = createGroupedBarChart(document.getElementById('tradeChart').getContext('2d'), data.economy.trade.exports);
                    document.querySelector('.trade-btn[data-type="exports"]').classList.add('active');
                }
                break;
            case 'living':
                if (!costLivingChart) {
                    costLivingChart = createBarChart(document.getElementById('costLivingChart').getContext('2d'), data.living.costs.student.labels, data.living.costs.student.data, 'Monthly Cost (SGD)');
                    document.querySelector('.lifestyle-btn[data-lifestyle="student"]').classList.add('active');
                }
                if (!cityComparisonChart) {
                    cityComparisonChart = createBarChart(document.getElementById('cityComparisonChart').getContext('2d'), data.living.comparison.labels, data.living.comparison.data, 'Avg. Monthly Cost (SGD)', true);
                }
                break;
        }
    }

    document.getElementById('nav-menu').addEventListener('click', function(e) {
        if (e.target.tagName === 'A') {
            e.preventDefault();
            const hash = e.target.hash;
            window.location.hash = hash;
        }
    });
    
    window.addEventListener('hashchange', () => updateActiveSection(window.location.hash));
    updateActiveSection(window.location.hash || '#glance');

    const tradeButtons = document.getElementById('trade-buttons');
    tradeButtons.addEventListener('click', function(e) {
        if (e.target.classList.contains('trade-btn')) {
            const type = e.target.dataset.type;
            tradeChart.data.labels = data.economy.trade[type].labels;
            tradeChart.data.datasets[0].data = data.economy.trade[type].data;
            tradeChart.update();

            document.querySelectorAll('.trade-btn').forEach(btn => btn.classList.remove('active'));
            e.target.classList.add('active');
        }
    });

    const lifestyleButtons = document.getElementById('lifestyle-buttons');
    lifestyleButtons.addEventListener('click', function(e) {
         if (e.target.classList.contains('lifestyle-btn')) {
            const lifestyle = e.target.dataset.lifestyle;
            costLivingChart.data.labels = data.living.costs[lifestyle].labels;
            costLivingChart.data.datasets[0].data = data.living.costs[lifestyle].data;
            costLivingChart.update();
            
            document.querySelectorAll('.lifestyle-btn').forEach(btn => btn.classList.remove('active'));
            e.target.classList.add('active');
        }
    });

    const festivalsGrid = document.getElementById('festivals-grid');
    const festivalDetails = document.getElementById('festival-details');
    data.people.festivals.forEach(festival => {
        const festivalCard = document.createElement('div');
        festivalCard.className = 'p-4 bg-slate-100 rounded-lg cursor-pointer hover:bg-blue-100 hover:shadow-lg transition';
        festivalCard.textContent = festival.name;
        festivalCard.dataset.details = festival.details;
        festivalsGrid.appendChild(festivalCard);
    });
    festivalsGrid.addEventListener('click', e => {
        if(e.target.dataset.details) {
            festivalDetails.textContent = e.target.dataset.details;
            festivalDetails.style.display = 'block';
        }
    });

    const initiativesGrid = document.getElementById('smart-initiatives-grid');
    const initiativeDetails = document.getElementById('initiative-details');
    data.city.initiatives.forEach(init => {
        const initCard = document.createElement('div');
        initCard.className = 'p-4 bg-slate-100 rounded-lg cursor-pointer hover:bg-blue-100 hover:shadow-lg transition flex flex-col items-center justify-center';
        initCard.dataset.details = init.details;
        initCard.innerHTML = `<span class="text-4xl mb-2">${init.icon}</span><span class="font-semibold">${init.name}</span>`;
        initiativesGrid.appendChild(initCard);
    });
    initiativesGrid.addEventListener('click', e => {
        const card = e.target.closest('[data-details]');
        if(card) {
            initiativeDetails.textContent = card.dataset.details;
            initiativeDetails.style.display = 'block';
        }
    });

    const pillarsGrid = document.getElementById('green-plan-pillars-grid');
    data.future.pillars.forEach(pillar => {
        const pillarCard = document.createElement('div');
        pillarCard.className = 'p-4 bg-green-100 rounded-lg flex flex-col items-center justify-center';
        pillarCard.innerHTML = `<span class="text-3xl mb-2">${pillar.icon}</span><span class="font-semibold text-green-800 text-sm">${pillar.name}</span>`;
        pillarsGrid.appendChild(pillarCard);
    });

    // LLM Integration
    async function callGeminiAPI(prompt, outputElement, placeholderText = "Generating insight...") {
        outputElement.innerHTML = `<p class="text-center text-slate-500">${placeholderText}</p>`;
        outputElement.classList.remove('hidden');

        try {
            let chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            const payload = { contents: chatHistory };
            const apiKey = ""; 
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            const result = await response.json();
            if (result.candidates && result.candidates.length > 0 &&
                result.candidates[0].content && result.candidates[0].content.parts &&
                result.candidates[0].content.parts.length > 0) {
                const text = result.candidates[0].content.parts[0].text;
                outputElement.innerHTML = `<p>${text}</p>`;
            } else {
                outputElement.innerHTML = `<p class="text-red-600">Error: Could not generate response. Please try again.</p>`;
            }
        } catch (error) {
            outputElement.innerHTML = `<p class="text-red-600">Error during API call: ${error.message}</p>`;
            console.error('API call error:', error);
        }
    }

    // People Section - Cultural Insight Generator
    const culturalInsightBtn = document.getElementById('cultural-insight-btn');
    const culturalInsightOutput = document.getElementById('cultural-insight-output');
    culturalInsightBtn.addEventListener('click', function() {
        const selectedFestivalCard = festivalsGrid.querySelector('.bg-blue-100'); // If a specific one is selected
        let prompt = `Provide a unique cultural insight or a brief story about Singapore's multicultural society.`;
        if (selectedFestivalCard && selectedFestivalCard.textContent) {
            prompt = `Tell me a unique cultural insight or a brief story about the significance of ${selectedFestivalCard.textContent} in Singapore's multicultural society, expanding on its details.`;
        }
        callGeminiAPI(prompt, culturalInsightOutput, "Generating cultural insight...");
    });
    
    // Economy Section - Economic Trend Explainer
    const economicExplainerBtn = document.getElementById('economic-explainer-btn');
    const economicExplainerOutput = document.getElementById('economic-explainer-output');
    economicExplainerBtn.addEventListener('click', function() {
        const currentTradeType = document.querySelector('.trade-btn.active')?.dataset.type || 'exports';
        const currentTradeData = data.economy.trade[currentTradeType];
        const sectorData = data.economy.sectors;
        
        const prompt = `Based on Singapore's economic data (GDP sectors: Services ${sectorData.data[0]}%, Industry ${sectorData.data[1]}%, Agriculture ${sectorData.data[2]}%; top ${currentTradeType} partners: ${currentTradeData.labels.join(', ')}), explain the key strengths and challenges of its economy, and its reliance on global trade.`;
        callGeminiAPI(prompt, economicExplainerOutput, "Analyzing economic trends...");
    });

    // City Section - Smart City Idea Generator
    const smartCitySuggestBtn = document.getElementById('smart-city-suggest-btn');
    const smartCityPromptInput = document.getElementById('smart-city-prompt-input');
    const smartCityIdeasOutput = document.getElementById('smart-city-ideas-output');
    smartCitySuggestBtn.addEventListener('click', function() {
        const userPrompt = smartCityPromptInput.value.trim();
        let prompt = `Suggest innovative smart city initiatives for Singapore, considering its existing advancements (${data.city.initiatives.map(i => i.name).join(', ')}). Focus on practical ideas.`;
        if (userPrompt) {
            prompt = `Suggest innovative smart city initiatives for Singapore focusing on ${userPrompt}, considering its existing advancements (${data.city.initiatives.map(i => i.name).join(', ')}). Focus on practical ideas.`;
        }
        callGeminiAPI(prompt, smartCityIdeasOutput, "Brainstorming smart city ideas...");
    });

    // Living Here Section - Relocation Advice
    const relocationAdviceBtn = document.getElementById('relocation-advice-btn');
    const relocationAdviceOutput = document.getElementById('relocation-advice-output');
    relocationAdviceBtn.addEventListener('click', function() {
        const selectedLifestyle = document.querySelector('.lifestyle-btn.active')?.dataset.lifestyle || 'student';
        let prompt = `Provide practical relocation advice for someone moving to Singapore, tailored for a ${selectedLifestyle} lifestyle, specifically considering cost of living and general tips for adapting to the city.`;
        callGeminiAPI(prompt, relocationAdviceOutput, "Generating relocation advice...");
    });
});
</script>

</body>
</html>
